<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes, viewport-fit=cover">
  <title>Grace ¬∑ our love world üíï</title>
  <!-- Tailwind + Material Icons -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <!-- Romantic fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      font-family: 'Quicksand', sans-serif;
      background: linear-gradient(-45deg, #8B0000, #C71585, #DB7093, #FFB6C1, #FF69B4);
      background-size: 400% 400%;
      animation: gradientBG 20s ease infinite;
      min-height: 100vh;
      position: relative;
      overflow-x: hidden;
    }

    @keyframes gradientBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* Floating hearts background */
    .heart-bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
    }

    .floating-icon {
      position: absolute;
      color: rgba(255, 255, 255, 0.5);
      animation: floatHeart linear infinite;
      font-size: 24px;
      font-family: 'Material Icons';
    }

    @keyframes floatHeart {
      0% { transform: translateY(100vh) scale(0.3) rotate(0deg); opacity: 0; }
      20% { opacity: 0.7; }
      80% { opacity: 0.7; }
      100% { transform: translateY(-20vh) scale(1.2) rotate(360deg); opacity: 0; }
    }

    /* Main card */
    .love-card {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-radius: 48px;
      padding: 30px 20px;
      box-shadow: 0 30px 60px rgba(199, 21, 133, 0.4);
      border: 3px solid white;
      max-width: 550px;
      margin: 20px auto;
      position: relative;
      z-index: 10;
    }

    /* Navigation Tabs */
    .nav-tabs {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 25px;
      flex-wrap: wrap;
    }

    .nav-tab {
      background: rgba(255, 255, 255, 0.3);
      backdrop-filter: blur(5px);
      padding: 12px 20px;
      border-radius: 50px;
      cursor: pointer;
      font-weight: 600;
      color: white;
      transition: all 0.3s;
      border: 2px solid transparent;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 1rem;
    }

    .nav-tab.active {
      background: #ff1493;
      border-color: white;
      transform: scale(1.05);
      box-shadow: 0 10px 20px rgba(255, 20, 147, 0.4);
    }

    .nav-tab:hover {
      background: #ff69b4;
      transform: translateY(-2px);
    }

    /* Sections */
    .section {
      display: none;
      animation: fadeIn 0.5s ease;
    }

    .section.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Click if you love me button */
    .love-button {
      background: linear-gradient(45deg, #ff1493, #ff69b4, #ff1493);
      background-size: 200% 200%;
      animation: gradientMove 3s ease infinite;
      border: none;
      padding: 15px 30px;
      font-size: 1.8rem;
      font-family: 'Great Vibes', cursive;
      color: white;
      border-radius: 60px;
      cursor: pointer;
      box-shadow: 0 10px 30px rgba(255, 20, 147, 0.5);
      transition: all 0.3s;
      border: 3px solid white;
      width: 100%;
      margin: 15px 0;
    }

    .love-button:hover {
      transform: scale(1.05);
      box-shadow: 0 20px 40px rgba(255, 20, 147, 0.8);
    }

    @keyframes gradientMove {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* Gift boxes grid */
    .gift-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      margin: 20px 0;
    }

    .gift-box {
      background: linear-gradient(145deg, #fff0f5, #ffe4e1);
      border-radius: 30px;
      padding: 20px 10px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
      border: 3px solid white;
      box-shadow: 0 10px 20px rgba(255, 105, 180, 0.3);
      position: relative;
      overflow: hidden;
    }

    .gift-box::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
      animation: shine 3s infinite;
    }

    @keyframes shine {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .gift-box:hover {
      transform: translateY(-8px) scale(1.03);
      box-shadow: 0 20px 30px rgba(255, 20, 147, 0.5);
    }

    .gift-icon {
      font-size: 3rem;
      color: #ff1493;
      margin-bottom: 8px;
    }

    .gift-text {
      font-family: 'Dancing Script', cursive;
      font-size: 1.3rem;
      color: #c71585;
      font-weight: bold;
    }

    /* Game sections */
    .game-section {
      background: rgba(255, 240, 245, 0.9);
      border-radius: 40px;
      padding: 25px 15px;
      margin: 25px 0;
      border: 3px solid #ff69b4;
      box-shadow: 0 10px 30px rgba(255, 20, 147, 0.2);
    }

    .game-title {
      font-family: 'Great Vibes', cursive;
      font-size: 2.5rem;
      color: #c71585;
      text-align: center;
      margin-bottom: 10px;
    }

    .game-stats {
      display: flex;
      justify-content: space-between;
      background: white;
      padding: 12px 20px;
      border-radius: 50px;
      margin-bottom: 20px;
      border: 2px solid #ffb6c1;
    }

    /* Memory Match Grid */
    .memory-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
      margin: 20px 0;
    }

    .memory-card {
      aspect-ratio: 1;
      background: linear-gradient(145deg, #ff69b4, #ff1493);
      border-radius: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.4s;
      transform-style: preserve-3d;
      position: relative;
      box-shadow: 0 8px 15px rgba(199, 21, 133, 0.3);
    }

    .memory-card.flipped {
      background: white;
      transform: rotateY(180deg);
    }

    .memory-card.matched {
      background: #d4edda;
      cursor: default;
      opacity: 0.8;
      transform: scale(0.95);
      border: 2px solid #28a745;
    }

    .memory-card .front,
    .memory-card .back {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 20px;
    }

    .memory-card .front {
      background: linear-gradient(145deg, #ff69b4, #ff1493);
      color: white;
      transform: rotateY(0deg);
    }

    .memory-card .back {
      background: white;
      transform: rotateY(180deg);
      font-size: 2rem;
    }

    .memory-card.flipped .front {
      transform: rotateY(180deg);
    }

    .memory-card.flipped .back {
      transform: rotateY(0deg);
    }

    .memory-card.matched .back {
      background: #d4edda;
    }

    /* Name Match Game specific */
    .name-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
      margin: 20px 0;
    }

    .letter-card {
      aspect-ratio: 1;
      background: linear-gradient(145deg, #ff69b4, #ff1493);
      border-radius: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.4s;
      transform-style: preserve-3d;
      position: relative;
      box-shadow: 0 8px 15px rgba(199, 21, 133, 0.3);
      font-size: 2rem;
      font-weight: bold;
      color: white;
    }

    .letter-card.flipped {
      background: white;
      color: #ff1493;
      transform: rotateY(180deg);
    }

    .letter-card.matched {
      background: #d4edda;
      cursor: default;
      opacity: 0.8;
      transform: scale(0.95);
      border: 2px solid #28a745;
      color: #28a745;
    }

    .letter-card .front,
    .letter-card .back {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 20px;
    }

    .letter-card .front {
      background: linear-gradient(145deg, #ff69b4, #ff1493);
      color: white;
      transform: rotateY(0deg);
    }

    .letter-card .back {
      background: white;
      color: #ff1493;
      transform: rotateY(180deg);
      font-size: 2rem;
      font-weight: bold;
    }

    .letter-card.flipped .front {
      transform: rotateY(180deg);
    }

    .letter-card.flipped .back {
      transform: rotateY(0deg);
    }

    .love-percentage {
      font-size: 3rem;
      font-family: 'Great Vibes', cursive;
      color: #ff1493;
      text-align: center;
      margin: 20px 0;
      animation: pulse 2s infinite;
    }

    .progress-bar {
      width: 100%;
      height: 30px;
      background: #ffe4e1;
      border-radius: 50px;
      overflow: hidden;
      margin: 20px 0;
      border: 2px solid white;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #ff69b4, #ff1493);
      transition: width 0.5s;
      width: 0%;
    }

    /* Message popup */
    .message-popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      padding: 30px;
      border-radius: 50px;
      box-shadow: 0 30px 60px rgba(0,0,0,0.3);
      z-index: 1000;
      max-width: 350px;
      width: 90%;
      text-align: center;
      border: 5px solid #ffb6c1;
    }

    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      z-index: 999;
    }

    .hidden {
      display: none;
    }

    /* Pulse animation */
    .pulse {
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    /* Confetti */
    .confetti {
      position: fixed;
      width: 10px;
      height: 10px;
      background: #ff69b4;
      top: -10px;
      animation: confettiFall 3s linear forwards;
      z-index: 2000;
    }

    @keyframes confettiFall {
      0% { transform: translateY(0) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
    }

    .heart-beat {
      animation: heartBeat 1.4s ease-in-out infinite;
    }
    @keyframes heartBeat {
      0% { transform: scale(1); }
      14% { transform: scale(1.2); }
      28% { transform: scale(1); }
      42% { transform: scale(1.2); }
      70% { transform: scale(1); }
    }

    .reset-button {
      background: #ff1493;
      color: white;
      border: none;
      padding: 12px 25px;
      border-radius: 50px;
      cursor: pointer;
      font-size: 1.1rem;
      display: inline-flex;
      align-items: center;
      gap: 10px;
      margin: 10px 0;
      border: 2px solid white;
    }

    .reset-button:hover {
      background: #c71585;
      transform: scale(1.05);
    }
  </style>
</head>
<body>

  <!-- Floating hearts background -->
  <div class="heart-bg" id="heartCanvas"></div>

  <!-- Main content -->
  <div class="min-h-screen flex items-center justify-center p-3">
    <div class="love-card">
      
      <!-- Header with name -->
      <div class="text-center mb-4">
        <span class="material-icons text-4xl text-pink-600 heart-beat">favorite</span>
        <h1 class="font-['Great_Vibes'] text-4xl text-red-600 mt-1">My Dearest Grace</h1>
        <p class="text-gray-600 text-sm">Everything I made with love for you...</p>
      </div>

      <!-- Navigation Tabs -->
      <div class="nav-tabs">
        <div class="nav-tab active" onclick="switchSection('love')">
          <span class="material-icons">favorite</span> Love
        </div>
        <div class="nav-tab" onclick="switchSection('gifts')">
          <span class="material-icons">card_giftcard</span> Gifts
        </div>
        <div class="nav-tab" onclick="switchSection('memory')">
          <span class="material-icons">memory</span> Memories
        </div>
        <div class="nav-tab" onclick="switchSection('namegame')">
          <span class="material-icons">abc</span> Name Game
        </div>
      </div>

      <!-- LOVE Section -->
      <div id="loveSection" class="section active">
        <!-- Click if you love me button -->
        <button onclick="showLoveMessage()" class="love-button pulse" id="loveButton">
          ‚ù§Ô∏è Click if you love me ‚ù§Ô∏è
        </button>

        <!-- Acceptance message (hidden initially) -->
        <div id="acceptanceMessage" class="hidden text-center mt-4 p-5 bg-pink-50 rounded-3xl border-3 border-pink-300">
          <span class="material-icons text-4xl text-pink-600">favorite</span>
          <h3 class="font-['Great_Vibes'] text-2xl text-red-600 mt-1">You said YES!</h3>
          <p class="text-gray-700 text-sm mt-2 leading-relaxed" id="acceptanceText"></p>
        </div>
      </div>

      <!-- GIFTS Section -->
      <div id="giftsSection" class="section">
        <h2 class="font-['Dancing_Script'] text-2xl text-pink-600 text-center mb-3">
          Choose a gift, my love üéÅ
        </h2>
        
        <div class="gift-grid">
          <div class="gift-box" onclick="openGift(1)">
            <span class="material-icons gift-icon">card_giftcard</span>
            <span class="gift-text">Be Mine Forever</span>
          </div>
          <div class="gift-box" onclick="openGift(2)">
            <span class="material-icons gift-icon">redeem</span>
            <span class="gift-text">Endless Kisses</span>
          </div>
          <div class="gift-box" onclick="openGift(3)">
            <span class="material-icons gift-icon">celebration</span>
            <span class="gift-text">Forever Love</span>
          </div>
          <div class="gift-box" onclick="openGift(4)">
            <span class="material-icons gift-icon">spa</span>
            <span class="gift-text">My Whole Heart</span>
          </div>
        </div>
      </div>

      <!-- MEMORY MATCH Section -->
      <div id="memorySection" class="section">
        <div class="game-section">
          <div class="game-title">üíï Memory Match üíï</div>
          
          <div class="game-stats">
            <span><span class="material-icons text-pink-500 align-middle">favorite</span> Score: <span id="score">0</span></span>
            <span><span class="material-icons text-pink-500 align-middle">stars</span> Level: <span id="level">1</span></span>
            <span><span class="material-icons text-pink-500 align-middle">celebration</span> Matches: <span id="matches">0</span>/<span id="totalPairs">6</span></span>
          </div>

          <div class="memory-grid" id="memoryGrid"></div>

          <div class="game-message" id="gameMessage">
            <span class="material-icons text-pink-500">favorite</span>
            Match the love memories!
            <span class="material-icons text-pink-500">favorite</span>
          </div>

          <div class="love-quote" id="loveQuote">
            "Every love story is beautiful, but ours is my favorite."
          </div>

          <div class="text-center">
            <button onclick="resetMemoryGame()" class="reset-button">
              <span class="material-icons">favorite</span>
              New Game
              <span class="material-icons">favorite</span>
            </button>
          </div>
        </div>
      </div>

      <!-- NAME MATCH GAME Section -->
      <div id="nameGameSection" class="section">
        <div class="game-section">
          <div class="game-title">üíï Name Love Game üíï</div>
          
          <div class="text-center mb-4">
            <span class="text-2xl font-['Dancing_Script'] text-pink-600">Grace</span>
            <span class="material-icons text-pink-400 mx-2">favorite</span>
            <span class="text-2xl font-['Dancing_Script'] text-pink-600">Alhaj</span>
          </div>

          <div class="game-stats">
            <span><span class="material-icons text-pink-500 align-middle">favorite</span> Matches: <span id="nameMatches">0</span>/<span id="totalLetters">9</span></span>
            <span><span class="material-icons text-pink-500 align-middle">percent</span> Love: <span id="lovePercent">0</span>%</span>
          </div>

          <!-- Name Match Grid -->
          <div class="name-grid" id="nameGrid"></div>

          <!-- Love Percentage Display -->
          <div class="love-percentage" id="lovePercentageDisplay">0% Love</div>

          <!-- Progress Bar -->
          <div class="progress-bar">
            <div class="progress-fill" id="loveProgress" style="width: 0%"></div>
          </div>

          <div class="game-message" id="nameGameMessage">
            <span class="material-icons text-pink-500">favorite</span>
            Match letters from our names!
            <span class="material-icons text-pink-500">favorite</span>
          </div>

          <div class="text-center">
            <button onclick="resetNameGame()" class="reset-button">
              <span class="material-icons">favorite</span>
              New Game
              <span class="material-icons">favorite</span>
            </button>
          </div>
        </div>
      </div>

      <!-- Romantic footer -->
      <div class="text-center mt-4 text-gray-500 text-xs">
        <span class="material-icons align-middle text-pink-400 text-sm">favorite</span>
        Made with infinite love for Grace
        <span class="material-icons align-middle text-pink-400 text-sm">favorite</span>
      </div>
    </div>
  </div>

  <!-- Message popup -->
  <div id="messagePopup" class="message-popup hidden">
    <span id="popupIcon" class="material-icons text-5xl text-pink-600">favorite</span>
    <p id="popupText" class="text-lg text-pink-600 font-['Dancing_Script'] my-3"></p>
    <button onclick="closePopup()" class="bg-pink-500 text-white px-5 py-2 rounded-full w-full text-sm">Close</button>
  </div>
  <div id="overlay" class="overlay hidden" onclick="closePopup()"></div>

  <script>
    // ==================== NAVIGATION ====================
    function switchSection(section) {
      // Hide all sections
      document.getElementById('loveSection').classList.remove('active');
      document.getElementById('giftsSection').classList.remove('active');
      document.getElementById('memorySection').classList.remove('active');
      document.getElementById('nameGameSection').classList.remove('active');
      
      // Remove active class from all tabs
      document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
      
      // Show selected section
      if (section === 'love') {
        document.getElementById('loveSection').classList.add('active');
        document.querySelectorAll('.nav-tab')[0].classList.add('active');
      } else if (section === 'gifts') {
        document.getElementById('giftsSection').classList.add('active');
        document.querySelectorAll('.nav-tab')[1].classList.add('active');
      } else if (section === 'memory') {
        document.getElementById('memorySection').classList.add('active');
        document.querySelectorAll('.nav-tab')[2].classList.add('active');
        initMemoryGame(); // Initialize memory game when switching to it
      } else if (section === 'namegame') {
        document.getElementById('nameGameSection').classList.add('active');
        document.querySelectorAll('.nav-tab')[3].classList.add('active');
        initNameGame(); // Initialize name game when switching to it
      }
      
      createConfetti(10);
    }

    // ==================== LOVE SECTION ====================
    function showLoveMessage() {
      createConfetti(50);
      const popup = document.getElementById('messagePopup');
      const overlay = document.getElementById('overlay');
      const icon = document.getElementById('popupIcon');
      const text = document.getElementById('popupText');
      
      icon.textContent = 'favorite';
      text.textContent = 'I love you too, Grace! More than words can say... ‚ù§Ô∏è';
      
      popup.classList.remove('hidden');
      overlay.classList.remove('hidden');
      
      // Show acceptance message
      setTimeout(() => {
        const acceptance = document.getElementById('acceptanceMessage');
        const acceptanceText = document.getElementById('acceptanceText');
        acceptanceText.textContent = 'My heart is yours forever. Every beat whispers your name, every breath is a prayer for your happiness. You are my today, my tomorrow, and my always. I promise to love you, cherish you, and make you smile every single day. Will you be mine forever?';
        acceptance.classList.remove('hidden');
      }, 500);
    }

    // ==================== GIFTS SECTION ====================
    function openGift(giftNumber) {
      createConfetti(20);
      const popup = document.getElementById('messagePopup');
      const overlay = document.getElementById('overlay');
      const icon = document.getElementById('popupIcon');
      const text = document.getElementById('popupText');
      
      const gifts = {
        1: { icon: 'card_giftcard', text: 'Be Mine Forever - I choose you, today, tomorrow, and always. You are my forever person, my soulmate, my everything.' },
        2: { icon: 'redeem', text: 'Endless Kisses - Every kiss I give you will be filled with passion, tenderness, and all the love in my heart. You deserve infinite affection.' },
        3: { icon: 'celebration', text: 'Forever Love - My love for you has no end. It grows stronger every day, deeper every moment, more beautiful with every heartbeat.' },
        4: { icon: 'spa', text: 'My Whole Heart - I give you my heart completely, without reservation, without hesitation. It belongs to you and only you.' }
      };
      
      const gift = gifts[giftNumber];
      icon.textContent = gift.icon;
      text.textContent = gift.text;
      
      popup.classList.remove('hidden');
      overlay.classList.remove('hidden');
    }

    // ==================== MEMORY MATCH GAME ====================
    const memoryPairs = [
      { id: 1, icon: 'favorite', text: 'First Kiss', emoji: 'üíã' },
      { id: 2, icon: 'beach_access', text: 'Sunset Walk', emoji: 'üåÖ' },
      { id: 3, icon: 'cake', text: 'Birthday Surprise', emoji: 'üéÇ' },
      { id: 4, icon: 'umbrella', text: 'Rainy Day Hug', emoji: '‚òî' },
      { id: 5, icon: 'coffee', text: 'Coffee Date', emoji: '‚òï' },
      { id: 6, icon: 'music_note', text: 'Our Song', emoji: 'üéµ' }
    ];

    const loveQuotes = [
      "Every love story is beautiful, but ours is my favorite.",
      "You are the poem I never knew how to write.",
      "In your eyes, I found my forever home.",
      "I love you more than all the stars in the sky.",
      "You're my today, my tomorrow, and my always.",
      "My heart beats only for you, Grace."
    ];

    let memoryCards = [];
    let flippedMemoryCards = [];
    let matchedMemoryPairs = 0;
    let memoryScore = 0;
    let memoryLevel = 1;
    let canFlipMemory = true;

    function initMemoryGame() {
      let numPairs = Math.min(4 + memoryLevel, memoryPairs.length);
      document.getElementById('totalPairs').textContent = numPairs;
      
      let selectedPairs = memoryPairs.slice(0, numPairs);
      
      memoryCards = [];
      selectedPairs.forEach((pair) => {
        memoryCards.push({ id: pair.id, icon: pair.icon, text: pair.text, matched: false, cardId: Math.random() });
        memoryCards.push({ id: pair.id, icon: pair.icon, text: pair.text, matched: false, cardId: Math.random() });
      });
      
      memoryCards = shuffleArray(memoryCards);
      
      matchedMemoryPairs = 0;
      document.getElementById('matches').textContent = matchedMemoryPairs;
      flippedMemoryCards = [];
      renderMemoryGrid();
    }

    function renderMemoryGrid() {
      let html = '';
      memoryCards.forEach((card, index) => {
        let cardClass = 'memory-card';
        if (card.matched) cardClass += ' matched';
        html += `
          <div class="${cardClass}" onclick="flipMemoryCard(this, ${index})" data-index="${index}">
            <div class="front"><span class="material-icons text-white text-2xl">favorite</span></div>
            <div class="back"><span class="material-icons text-pink-600 text-2xl">${card.icon}</span></div>
          </div>
        `;
      });
      document.getElementById('memoryGrid').innerHTML = html;
    }

    function flipMemoryCard(element, index) {
      if (!canFlipMemory) return;
      if (memoryCards[index].matched) return;
      if (flippedMemoryCards.includes(index)) return;
      if (flippedMemoryCards.length >= 2) return;

      element.classList.add('flipped');
      flippedMemoryCards.push(index);

      if (flippedMemoryCards.length === 2) {
        checkMemoryMatch();
      }
    }

    function checkMemoryMatch() {
      canFlipMemory = false;
      let card1 = memoryCards[flippedMemoryCards[0]];
      let card2 = memoryCards[flippedMemoryCards[1]];

      if (card1.id === card2.id) {
        setTimeout(() => {
          memoryCards[flippedMemoryCards[0]].matched = true;
          memoryCards[flippedMemoryCards[1]].matched = true;
          
          document.querySelector(`[data-index="${flippedMemoryCards[0]}"]`).classList.add('matched');
          document.querySelector(`[data-index="${flippedMemoryCards[1]}"]`).classList.add('matched');
          
          matchedMemoryPairs++;
          document.getElementById('matches').textContent = matchedMemoryPairs;
          memoryScore += 10 * memoryLevel;
          document.getElementById('score').textContent = memoryScore;
          
          document.getElementById('gameMessage').innerHTML = `<span class="text-green-600">üíï Perfect match! That's our ${card1.text} memory! üíï</span>`;
          createConfetti(10);
          
          if (matchedMemoryPairs === memoryCards.length / 2) {
            levelComplete();
          }
          
          flippedMemoryCards = [];
          canFlipMemory = true;
        }, 500);
      } else {
        setTimeout(() => {
          document.querySelector(`[data-index="${flippedMemoryCards[0]}"]`).classList.remove('flipped');
          document.querySelector(`[data-index="${flippedMemoryCards[1]}"]`).classList.remove('flipped');
          
          document.getElementById('gameMessage').innerHTML = `<span class="text-pink-600">Not a match... but our love is always perfect ‚ù§Ô∏è</span>`;
          
          flippedMemoryCards = [];
          canFlipMemory = true;
        }, 800);
      }
    }

    function levelComplete() {
      memoryLevel++;
      document.getElementById('level').textContent = memoryLevel;
      
      let quoteIndex = (memoryLevel - 1) % loveQuotes.length;
      document.getElementById('loveQuote').textContent = `"${loveQuotes[quoteIndex]}"`;
      
      document.getElementById('gameMessage').innerHTML = `<span class="text-purple-600 font-bold">‚ú® LEVEL ${memoryLevel-1} COMPLETE! ‚ú®</span>`;
      createConfetti(30);
      
      memoryScore += 50;
      document.getElementById('score').textContent = memoryScore;
      
      setTimeout(() => {
        initMemoryGame();
      }, 1500);
    }

    function resetMemoryGame() {
      memoryLevel = 1;
      memoryScore = 0;
      document.getElementById('score').textContent = memoryScore;
      document.getElementById('level').textContent = memoryLevel;
      document.getElementById('loveQuote').textContent = `"${loveQuotes[0]}"`;
      initMemoryGame();
      createConfetti(15);
    }

    // ==================== NAME MATCH GAME ====================
    const graceName = ['G', 'R', 'A', 'C', 'E'];
    const alhajName = ['A', 'L', 'H', 'A', 'J'];
    const allLetters = [...graceName, ...alhajName];

    let nameCards = [];
    let flippedNameCards = [];
    let matchedNamePairs = 0;
    let canFlipName = true;
    let lovePercentage = 0;

    function initNameGame() {
      // Create cards for each letter (two of each for matching)
      nameCards = [];
      
      // Add Grace's letters
      graceName.forEach(letter => {
        nameCards.push({ letter: letter, owner: 'grace', matched: false, id: Math.random() });
        nameCards.push({ letter: letter, owner: 'grace', matched: false, id: Math.random() });
      });
      
      // Add Alhaj's letters
      alhajName.forEach(letter => {
        nameCards.push({ letter: letter, owner: 'alhaj', matched: false, id: Math.random() });
        nameCards.push({ letter: letter, owner: 'alhaj', matched: false, id: Math.random() });
      });
      
      nameCards = shuffleArray(nameCards);
      
      matchedNamePairs = 0;
      lovePercentage = 0;
      document.getElementById('nameMatches').textContent = matchedNamePairs;
      document.getElementById('totalLetters').textContent = graceName.length + alhajName.length;
      document.getElementById('lovePercent').textContent = lovePercentage;
      document.getElementById('lovePercentageDisplay').textContent = '0% Love';
      document.getElementById('loveProgress').style.width = '0%';
      
      flippedNameCards = [];
      renderNameGrid();
    }

    function renderNameGrid() {
      let html = '';
      nameCards.forEach((card, index) => {
        let cardClass = 'letter-card';
        if (card.matched) cardClass += ' matched';
        html += `
          <div class="${cardClass}" onclick="flipNameCard(this, ${index})" data-index="${index}">
            <div class="front"><span class="text-2xl">?</span></div>
            <div class="back"><span class="text-2xl" style="color: ${card.owner === 'grace' ? '#ff1493' : '#c71585'}">${card.letter}</span></div>
          </div>
        `;
      });
      document.getElementById('nameGrid').innerHTML = html;
    }

    function flipNameCard(element, index) {
      if (!canFlipName) return;
      if (nameCards[index].matched) return;
      if (flippedNameCards.includes(index)) return;
      if (flippedNameCards.length >= 2) return;

      element.classList.add('flipped');
      flippedNameCards.push(index);

      if (flippedNameCards.length === 2) {
        checkNameMatch();
      }
    }

    function checkNameMatch() {
      canFlipName = false;
      let card1 = nameCards[flippedNameCards[0]];
      let card2 = nameCards[flippedNameCards[1]];

      // Check if they match (same letter and different owners)
      if (card1.letter === card2.letter && card1.owner !== card2.owner) {
        // PERFECT MATCH!
        setTimeout(() => {
          nameCards[flippedNameCards[0]].matched = true;
          nameCards[flippedNameCards[1]].matched = true;
          
          document.querySelector(`[data-index="${flippedNameCards[0]}"]`).classList.add('matched');
          document.querySelector(`[data-index="${flippedNameCards[1]}"]`).classList.add('matched');
          
          matchedNamePairs++;
          lovePercentage = Math.round((matchedNamePairs / (graceName.length + alhajName.length)) * 100);
          
          document.getElementById('nameMatches').textContent = matchedNamePairs;
          document.getElementById('lovePercent').textContent = lovePercentage;
          document.getElementById('lovePercentageDisplay').textContent = lovePercentage + '% Love';
          document.getElementById('loveProgress').style.width = lovePercentage + '%';
          
          // Romantic messages based on percentage
          let message = '';
          if (lovePercentage < 30) message = 'üíï Our love is growing!';
          else if (lovePercentage < 60) message = 'üíñ We\'re getting there!';
          else if (lovePercentage < 80) message = 'üíó Almost perfect!';
          else if (lovePercentage < 100) message = 'üíò So close to 100%!';
          else message = 'üíû 100% PERFECT LOVE! We are meant to be!';
          
          document.getElementById('nameGameMessage').innerHTML = `<span class="text-green-600">${message}</span>`;
          createConfetti(15);
          
          // Check if game complete
          if (matchedNamePairs === graceName.length + alhajName.length) {
            gameComplete();
          }
          
          flippedNameCards = [];
          canFlipName = true;
        }, 500);
      } else {
        // No match
        setTimeout(() => {
          document.querySelector(`[data-index="${flippedNameCards[0]}"]`).classList.remove('flipped');
          document.querySelector(`[data-index="${flippedNameCards[1]}"]`).classList.remove('flipped');
          
          document.getElementById('nameGameMessage').innerHTML = `<span class="text-pink-600">Not a match... try again ‚ù§Ô∏è</span>`;
          
          flippedNameCards = [];
          canFlipName = true;
        }, 800);
      }
    }

    function gameComplete() {
      document.getElementById('nameGameMessage').innerHTML = `<span class="text-purple-600 font-bold">‚ú® 100% LOVE! We are perfect together! ‚ú®</span>`;
      createConfetti(50);
      
      // Show special popup
      setTimeout(() => {
        const popup = document.getElementById('messagePopup');
        const overlay = document.getElementById('overlay');
        const icon = document.getElementById('popupIcon');
        const text = document.getElementById('popupText');
        
        icon.textContent = 'favorite';
        text.textContent = '100% LOVE! Grace and Alhaj are meant to be! üíï';
        
        popup.classList.remove('hidden');
        overlay.classList.remove('hidden');
      }, 500);
    }

    function resetNameGame() {
      initNameGame();
      createConfetti(15);
      document.getElementById('nameGameMessage').innerHTML = '<span class="material-icons text-pink-500">favorite</span> Match our letters! <span class="material-icons text-pink-500">favorite</span>';
    }

    // ==================== UTILITY FUNCTIONS ====================
    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function initHearts() {
      const canvas = document.getElementById('heartCanvas');
      for (let i = 0; i < 20; i++) {
        const heart = document.createElement('span');
        heart.className = 'material-icons floating-icon';
        heart.textContent = 'favorite';
        heart.style.left = Math.random() * 100 + '%';
        heart.style.animationDuration = (Math.random() * 10 + 8) + 's';
        heart.style.animationDelay = Math.random() * 5 + 's';
        heart.style.fontSize = (Math.random() * 20 + 15) + 'px';
        heart.style.opacity = 0.3;
        canvas.appendChild(heart);
      }
    }

    function createConfetti(count = 30) {
      for (let i = 0; i < count; i++) {
        setTimeout(() => {
          const confetti = document.createElement('div');
          confetti.className = 'confetti';
          confetti.style.left = Math.random() * 100 + '%';
          confetti.style.background = `hsl(${Math.random() * 30 + 330}, 80%, 70%)`;
          confetti.style.width = (Math.random() * 12 + 5) + 'px';
          confetti.style.height = (Math.random() * 12 + 5) + 'px';
          confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
          document.body.appendChild(confetti);
          setTimeout(() => confetti.remove(), 3000);
        }, i * 20);
      }
    }

    function closePopup() {
      document.getElementById('messagePopup').classList.add('hidden');
      document.getElementById('overlay').classList.add('hidden');
    }

    // Initialize everything
    window.onload = function() {
      initHearts();
      initMemoryGame();
      initNameGame();
      createConfetti(20);
    };
  </script>
</body>
</html>